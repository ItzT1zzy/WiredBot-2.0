import time
from contextlib import suppress

from aiogram import Router, types
from aiogram.filters import CommandStart
from aiogram.types import KeyboardButton
from pymongo.errors import DuplicateKeyError
from pymongo.mongo_client import MongoClient

import config
from keyboards.reply import start_keyboard, admin_start_keyboard

router = Router()
cluster = MongoClient(config.MONGODB_URI)
db = cluster.tgdb


@router.message(CommandStart())
async def start(message: types.Message):
    with suppress(DuplicateKeyError):
        db.users.insert_one(
            dict(
                _id=message.from_user.id,
                name=str(message.from_user.full_name),
                bal=300,
                friends=0,
                role="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                news=True
            )
        )
    if message.from_user.id in config.ADMIN_ID:
        await message.answer_sticker("CAACAgUAAxkBAAELaURlzlWNWIyn-2JVeTecMZ-o9hJY_wAC5gEAApHbgFWkJ7qbgopTnzQE")
        admin_welcome_message = ("üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, —É–≤–∞–∂–∞–µ–º—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!\n\n"
                                 "–í—ã –≤–æ—à–ª–∏ –≤ —Ä–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±–æ—Ç–∞ WiredBot. –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ –±–æ—Ç–∞ –∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –µ–≥–æ —Ä–∞–±–æ—Ç–æ–π.\n"
                                 "–ù–µ –∑–∞–±—É–¥—å—Ç–µ –±—ã—Ç—å –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞.\n"
                                 "–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–∞–∫–∏–µ-–ª–∏–±–æ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º.\n"
                                 "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É —Ä–∞–±–æ—Ç—É –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É! üôè")
        await message.answer(admin_welcome_message, reply_markup=admin_start_keyboard)
    else:
        welcome_message = ("ü§ñ <b>WiredBot</b> - –≤–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ –º–∏—Ä–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π! üöÄ\n\n"
                           "üéâ –ß—Ç–æ —è –º–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å: \n"
                           "‚Ä¢ üë• <b>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥—Ä—É–∑—å—è:</b> –ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø–æ–º–æ—á—å –≤–∞–º —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–∞—à –∫—Ä—É–≥ –æ–±—â–µ–Ω–∏—è, –¥–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã—Ö –¥—Ä—É–∑–µ–π –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –µ–¥–∏–Ω–æ–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤.\n"
                           "‚Ä¢ üëÄ <b>–ú–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ:</b> –≠—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ! –ú–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –∏ —è –≥–æ—Ç–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞–º –µ—â–µ –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π. üí°\n\n"
                           "ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å: \n"
                           "–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º. –ú—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º –∏ —É–ª—É—á—à–∏—Ç—å –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –¥–ª—è –≤–∞—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞.\n–î–ª—è —Å–≤—è–∑–∏ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ–∑–¥–∞—Ç–µ–ª—é: @ItzT1zzy.\n–ê —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø–æ—Å–µ—Ç–∏—Ç—å –Ω–∞—à —Ç–µ–ª–µ–≥—Ä–∞–º –∫–∞–Ω–∞–ª: <i>–°–∫–æ—Ä–æ...</i>\n\n"
                           "–ü—Ä–æ—Å—Ç–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –º–Ω–µ –≤–æ–ø—Ä–æ—Å, –∏ —è —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º –ø–æ–º–æ–≥—É –≤–∞–º. –í–º–µ—Å—Ç–µ –º—ã —Å–¥–µ–ª–∞–µ–º –≤–∞—à–µ –≤—Ä–µ–º—è –≤ Telegram –±–æ–ª–µ–µ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–º! üåü\n\n"
                           "–ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –æ–±—â–∞—Ç—å—Å—è –∏ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è —ç—Ç–∏–º –æ–ø—ã—Ç–æ–º! üåà\n\n"
                           "–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è! üöÄ")
        await message.answer_sticker("CAACAgUAAxkBAAELaURlzlWNWIyn-2JVeTecMZ-o9hJY_wAC5gEAApHbgFWkJ7qbgopTnzQE")
        time.sleep(0.5)
        await message.answer(welcome_message, reply_markup=start_keyboard)
